<!DOCTYPE html><!--jXTUow4yCUmqave0BMZ2f--><html lang="en" class="light __variable_cc5bd2 __variable_9f010c"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/><link rel="preload" href="/_next/static/media/0703289cbb03d1b5-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/2f66d2cded5eb62b-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/4195ccbd93429073-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/4b25ba58b96bf829-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/5191fc87febab105-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/6f4b1b8a3bb362a3-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/a155a31b509d9798-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/b1373ee6909ce2f4-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/b817805ccb9a2b4a-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/be78684d432e3822-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/c8897484f20cb9bc-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/dd2c1f56eea99b69-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/e6581a79ce8b3a05-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/ee0a4d0f22f144a3-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/017825a64ef30acf.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-f1708cd464e6335f.js"/><script src="/_next/static/chunks/9c757011-f0a6af16cd395ae7.js" async=""></script><script src="/_next/static/chunks/276-0eb204165e3efecb.js" async=""></script><script src="/_next/static/chunks/main-app-9eacf96ad541f266.js" async=""></script><script src="/_next/static/chunks/952-93a0312470798b49.js" async=""></script><script src="/_next/static/chunks/60-b5a4faedd1c7331c.js" async=""></script><script src="/_next/static/chunks/463-e6ae5b1b34dd90ae.js" async=""></script><script src="/_next/static/chunks/app/(index)/blog/%5B...slug%5D/page-a938057c8b529094.js" async=""></script><meta name="next-size-adjust" content=""/><meta name="theme-color" content="#f4f4f5"/><title>NPM package deployment using YAML GitHub Actions | Jaxson Van Doorn</title><meta name="description" content="All-around developer, half-designer and tinkerer."/><link rel="manifest" href="/manifest.webmanifest"/><meta name="creator" content="Jaxson Van Doorn"/><meta name="publisher" content="Jaxson Van Doorn"/><meta property="og:title" content="Jaxson Van Doorn"/><meta property="og:description" content="All-around developer, half-designer and tinkerer."/><meta property="og:image:type" content="image/png"/><meta property="og:image" content="https://jaxs.onl/meta-image.png"/><meta property="og:image:alt" content="Cover image for jaxs.onl"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:creator" content="@jaxsonvandoorn"/><meta name="twitter:title" content="NPM package deployment using YAML GitHub Actions"/><meta name="twitter:description" content="All-around developer, half-designer and tinkerer."/><meta name="twitter:image" content="https://jaxs.onl/meta-image.png"/><meta name="twitter:image:alt" content="Cover image for jaxs.onl"/><link rel="shortcut icon" href="/favicon.png"/><link rel="icon" href="/favicon.png"/><link rel="apple-touch-icon" href="/icons/mask-32x32.png" sizes="32x32" type="image/png"/><link rel="apple-touch-icon" href="/icons/mask-48x48.png" sizes="48x48" type="image/png"/><link rel="apple-touch-icon" href="/icons/mask-72x72.png" sizes="72x72" type="image/png"/><link rel="apple-touch-icon" href="/icons/mask-144x144.png" sizes="144x144" type="image/png"/><link rel="apple-touch-icon" href="/icons/mask-192x192.png" sizes="192x192" type="image/png"/><link rel="apple-touch-icon" href="/icons/mask-256x256.png" sizes="256x256" type="image/png"/><link rel="apple-touch-icon" href="/icons/mask-384x384.png" sizes="384x384" type="image/png"/><link rel="apple-touch-icon" href="/icons/mask-512x512.png" sizes="512x512" type="image/png"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body><div hidden=""><!--$--><!--/$--></div><div id="__next"><div class="flex min-h-screen flex-col text-zinc-900 bg-zinc-100 dark-mode:text-neutral-800"><main class="min-w-0 box-border m-0 flex grow"><div class="min-w-0 box-border m-0 flex flex-col grow gap-y-0 max-h-screen overflow-y-auto fade-morph"><div class="min-w-0 box-border m-0 grow flex flex-col mx-auto w-full max-w-container [max-width:960px] px-4 sm:px-6 lg:px-8 py-2 sm:py-3 lg:py-4"><article class="flex-grow pt-6 prose relative"><div class="min-w-0 box-border m-0 absolute left-[-14px] top-[-14px] flex justify-end sm:top-[-22px] xl:hidden"><a class="px-4 py-4 block" aria-label="Back" href="/"><span class="min-w-0 box-border m-0 flex items-center flex-row gap-x-2 text-zinc-500 dark-mode:text-neutral-500"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M7.793 2.232a.75.75 0 0 1-.025 1.06L3.622 7.25h10.003a5.375 5.375 0 0 1 0 10.75H10.75a.75.75 0 0 1 0-1.5h2.875a3.875 3.875 0 0 0 0-7.75H3.622l4.146 3.957a.75.75 0 0 1-1.036 1.085l-5.5-5.25a.75.75 0 0 1 0-1.085l5.5-5.25a.75.75 0 0 1 1.06.025Z" clip-rule="evenodd"></path></svg><span class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">back</span></span></a></div><div class="min-w-0 box-border m-0 sticky hidden top-0 left-0 h-0 xl:block"><div class="min-w-0 box-border m-0 absolute top-[16px] left-[-160px]"><a class="px-4 py-4 block" aria-label="Back" href="/"><span class="min-w-0 box-border m-0 flex items-center flex-row gap-x-2 text-zinc-500 dark-mode:text-neutral-500"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 20 20" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M7.793 2.232a.75.75 0 0 1-.025 1.06L3.622 7.25h10.003a5.375 5.375 0 0 1 0 10.75H10.75a.75.75 0 0 1 0-1.5h2.875a3.875 3.875 0 0 0 0-7.75H3.622l4.146 3.957a.75.75 0 0 1-1.036 1.085l-5.5-5.25a.75.75 0 0 1 0-1.085l5.5-5.25a.75.75 0 0 1 1.06.025Z" clip-rule="evenodd"></path></svg><span class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">back</span></span></a></div></div><h1 class="min-w-0 box-border m-0 [font-family:var(--font-serif)] text-3xl font-medium mt-2.5 sm:mt-0 text-morph">NPM package deployment using YAML GitHub Actions</h1><p class="min-w-0 box-border m-0 text-lg sm:text-xl text-zinc-500 dark-mode:text-neutral-500">Wednesday, August 21, 2019</p><hr class="my-4 border-gray-200 dark-mode:border-zinc-300"/><p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">Recently <a href="http://github.com" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">GitHub</a> announced that <a href="https://github.com/features/actions" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">GitHub Actions</a> will be <a href="https://github.blog/2019-08-08-github-actions-now-supports-ci-cd/" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">moving away</a> from the original <a href="https://github.com/hashicorp/hcl" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">HCL</a> syntax in-favour of a <a href="https://yaml.org/" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">YAML</a> format
similar to <a href="https://travis-ci.org/" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">Travis CI</a> and <a href="https://bitbucket.org/product/features/pipelines" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">Bitbucket Pipelines</a>.  This means that <a href="https://github.com/hashicorp/hcl" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">HCL</a> style actions will no longer work <a href="https://developer.github.com/actions/" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">after September 30, 2019</a>.  It is possible to migrate using a <a href="https://help.github.com/en/articles/migrating-github-actions-from-hcl-syntax-to-yaml-syntax" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">migration script</a> however in-some cases it may be required to reconfigure.</p>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">This particular issue occurred to me as actions which return a neutral result seem to fail the whole build with the <a href="https://yaml.org/" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">YAML</a> format.  This means that using <a href="https://github.com/actions/bin/tree/master/filter/bin" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">actions/bin/filter</a> to trigger a deploy would fail the build unless a release tag was found.  With this in mind, reconfiguring my <a href="https://github.com/features/actions" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">GitHub Actions</a> seemed like the best choice.</p>
<a id="orgb58448b"></a>
<h2 id="desired-behaviour" class="min-w-0 box-border m-0 [font-family:var(--font-serif)] text-xl sm:text-2xl font-medium mt-2 mb-1"><a href="#desired-behaviour" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad] anchor"><span class="icon icon-link"></span></a>Desired Behaviour</h2>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">My particular use of <a href="https://github.com/features/actions" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">GitHub Actions</a> is for deploying my small <a href="https://docs.npmjs.com/creating-node-js-modules" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">NPM packages</a>.</p>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">To keep it simple I wanted the following to occur:</p>
<ul>
<li>Install dependencies, Build and Test package on each commit</li>
<li>Publish package if a release tag was created</li>
</ul>
<a id="org521573d"></a>
<h2 id="creating-the-action-configuration" class="min-w-0 box-border m-0 [font-family:var(--font-serif)] text-xl sm:text-2xl font-medium mt-2 mb-1"><a href="#creating-the-action-configuration" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad] anchor"><span class="icon icon-link"></span></a>Creating the Action Configuration</h2>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">Create the file <code>.github/workflows/workflow.yml</code></p>
<a id="org9bc8afb"></a>
<h3 id="checking-for-tag" class="min-w-0 box-border m-0 [font-family:var(--font-serif)] text-xl sm:text-2xl font-normal mt-2 mb-1"><a href="#checking-for-tag" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad] anchor"><span class="icon icon-link"></span></a>Checking for Tag</h3>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">This method simply builds and tests the package on any commit.</p>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">Then if it finds a tag starting with <strong class="font-semibold">v</strong>, it will trigger a deploy.</p>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">So if a <a href="https://help.github.com/en/articles/creating-releases" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">GitHub Release</a> is created with the tag <strong class="font-semibold">v2.3.4</strong>, it will trigger a deploy.</p>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">This is a bit naive however for my purposes I usually don&#x27;t tag unless its a release.</p>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">One advantage of checking for a tag this way is that it cuts down on unneeded builds as a whole build can only ever run 1 or 2 times (2 in the case a build is deployed).</p>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">The <a href="https://github.com/features/actions" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">GitHub Actions</a> docs mentions being able to <a href="https://help.github.com/en/articles/workflow-syntax-for-github-actions#example-restricting-the-workflow-run-to-specific-refs-and-paths" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">restrict actions</a> to certain branches or tags however I could not get this to work.</p>
<div data-rehype-pretty-code-fragment=""><pre data-language="yaml" data-theme="default" class="rounded-xl mb-2.5 mt-2 [line-height:1.42] bg-[#111118] text-[#aaaaca] [overflow:auto] [overflow-wrap:normal] p-6 text-xs sm:text-sm"><code data-language="yaml" data-theme="default"><span class="line"><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">build</span><span style="color:#AAAACA"> </span><span style="color:#787890;font-style:italic"># Name Action Build</span></span>
<span class="line"> </span>
<span class="line"><span style="color:#DD672C">on</span><span style="color:#AAAACA">: [</span><span style="color:#DD672C">push</span><span style="color:#AAAACA">]  </span><span style="color:#787890;font-style:italic"># Trigger on push</span></span>
<span class="line"> </span>
<span class="line"><span style="color:#AAAACA">jobs</span><span style="color:#AAAACA">:</span></span>
<span class="line"><span style="color:#AAAACA">  </span><span style="color:#AAAACA">run</span><span style="color:#AAAACA">:</span></span>
<span class="line"><span style="color:#AAAACA">    </span><span style="color:#AAAACA">runs-on</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">ubuntu-latest</span><span style="color:#AAAACA">                         </span><span style="color:#787890;font-style:italic"># Run on Ubuntu Docker image</span></span>
<span class="line"><span style="color:#AAAACA">    </span><span style="color:#AAAACA">steps</span><span style="color:#AAAACA">:</span></span>
<span class="line"><span style="color:#AAAACA">    - </span><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">Checkout Repo</span><span style="color:#AAAACA">                          </span><span style="color:#787890;font-style:italic"># Checkout repo</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">uses</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">actions/checkout@v1</span></span>
<span class="line"><span style="color:#AAAACA">    - </span><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">Use Node.js</span><span style="color:#AAAACA">                            </span><span style="color:#787890;font-style:italic"># Configure Node.js</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">uses</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">actions/setup-node@v1</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">with</span><span style="color:#AAAACA">:</span></span>
<span class="line"><span style="color:#AAAACA">        </span><span style="color:#AAAACA">node-version</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">&#x27;12.9&#x27;</span><span style="color:#AAAACA">                       </span><span style="color:#787890;font-style:italic"># Set Node.js Version</span></span>
<span class="line"><span style="color:#AAAACA">        </span><span style="color:#AAAACA">registry-url</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">&#x27;https://registry.npmjs.org&#x27;</span><span style="color:#AAAACA"> </span><span style="color:#787890;font-style:italic"># Set Node.js reigistry</span></span>
<span class="line"><span style="color:#AAAACA">    - </span><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">Deploy Info</span><span style="color:#AAAACA">                            </span><span style="color:#787890;font-style:italic"># Print GitHub Deploy info</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">env</span><span style="color:#AAAACA">:</span></span>
<span class="line"><span style="color:#AAAACA">        </span><span style="color:#AAAACA">GITHUB_CONTEXT</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">${{ toJson(github) }}</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">run</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">echo &quot;$GITHUB_CONTEXT&quot;</span></span>
<span class="line"><span style="color:#AAAACA">    - </span><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">Install</span><span style="color:#AAAACA">                                </span><span style="color:#787890;font-style:italic"># Install dependancies</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">run</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">npm install</span></span>
<span class="line"><span style="color:#AAAACA">    - </span><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">Build</span><span style="color:#AAAACA">                                  </span><span style="color:#787890;font-style:italic"># Build app if needed</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">run</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">npm run build --if-present</span></span>
<span class="line"><span style="color:#AAAACA">    - </span><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">Test</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">run</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">npm run test --if-present</span><span style="color:#AAAACA">               </span><span style="color:#787890;font-style:italic"># Run tests if needed</span></span>
<span class="line"><span style="color:#AAAACA">    - </span><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">Publish</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">if</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">startsWith(github.ref, &#x27;refs/tags/v&#x27;)</span><span style="color:#AAAACA">    </span><span style="color:#787890;font-style:italic"># Check if publish step should run</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">run</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">npm publish --access public</span><span style="color:#AAAACA">             </span><span style="color:#787890;font-style:italic"># Publish package</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">env</span><span style="color:#AAAACA">:</span></span>
<span class="line"><span style="color:#AAAACA">        </span><span style="color:#AAAACA">NODE_AUTH_TOKEN</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">${{ secrets.NPM_AUTH_TOKEN }}</span><span style="color:#AAAACA"> </span><span style="color:#787890;font-style:italic"># Set NPM auth token from GitHub Secrets</span></span></code></pre></div>
<a id="org2d248b4"></a>
<h3 id="checking-for-a-release" class="min-w-0 box-border m-0 [font-family:var(--font-serif)] text-xl sm:text-2xl font-normal mt-2 mb-1"><a href="#checking-for-a-release" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad] anchor"><span class="icon icon-link"></span></a>Checking for a Release</h3>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">If you found the previous method too naive, you may want to check for a <a href="https://help.github.com/en/articles/creating-releases" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">GitHub Release</a> before triggering a deploy.</p>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">The drawback to this is that a few extraneous builds will be triggered as the <code>release</code> event will fire both when the release is <code>created</code> and <code>published</code>.  As far as I am aware this can not be restricted using the <code>on</code> property.</p>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">To ensure we only deploy once, we will indicate to only run the <strong class="font-semibold">Publish</strong> step when a release is <code>published</code>.</p>
<div data-rehype-pretty-code-fragment=""><pre data-language="yaml" data-theme="default" class="rounded-xl mb-2.5 mt-2 [line-height:1.42] bg-[#111118] text-[#aaaaca] [overflow:auto] [overflow-wrap:normal] p-6 text-xs sm:text-sm"><code data-language="yaml" data-theme="default"><span class="line"><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">build</span></span>
<span class="line"> </span>
<span class="line"><span style="color:#DD672C">on</span><span style="color:#AAAACA">:</span></span>
<span class="line"><span style="color:#AAAACA">  </span><span style="color:#AAAACA">push</span><span style="color:#AAAACA">:     </span><span style="color:#787890;font-style:italic"># Run build on push (commit in most cases)</span></span>
<span class="line"><span style="color:#AAAACA">    </span><span style="color:#AAAACA">tag</span><span style="color:#AAAACA">: [] </span><span style="color:#787890;font-style:italic"># Only run build if not tagged</span></span>
<span class="line"><span style="color:#AAAACA">  </span><span style="color:#AAAACA">release</span><span style="color:#AAAACA">:  </span><span style="color:#787890;font-style:italic"># Run build on release</span></span>
<span class="line"><span style="color:#AAAACA">    </span><span style="color:#AAAACA">tag</span><span style="color:#AAAACA">:</span></span>
<span class="line"><span style="color:#AAAACA">    - </span><span style="color:#DD672C">v*</span><span style="color:#AAAACA">    </span><span style="color:#787890;font-style:italic"># Check for release tag</span></span>
<span class="line"> </span>
<span class="line"><span style="color:#AAAACA">jobs</span><span style="color:#AAAACA">:</span></span>
<span class="line"><span style="color:#AAAACA">  </span><span style="color:#AAAACA">run</span><span style="color:#AAAACA">:</span></span>
<span class="line"><span style="color:#AAAACA">    </span><span style="color:#AAAACA">runs-on</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">ubuntu-latest</span><span style="color:#AAAACA">                         </span><span style="color:#787890;font-style:italic"># Run on Ubuntu Docker image</span></span>
<span class="line"><span style="color:#AAAACA">    </span><span style="color:#AAAACA">steps</span><span style="color:#AAAACA">:</span></span>
<span class="line"><span style="color:#AAAACA">    - </span><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">Checkout Repo</span><span style="color:#AAAACA">                          </span><span style="color:#787890;font-style:italic"># Checkout repo</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">uses</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">actions/checkout@v1</span></span>
<span class="line"><span style="color:#AAAACA">    - </span><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">Use Node.js</span><span style="color:#AAAACA">                            </span><span style="color:#787890;font-style:italic"># Configure Node.js</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">uses</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">actions/setup-node@v1</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">with</span><span style="color:#AAAACA">:</span></span>
<span class="line"><span style="color:#AAAACA">        </span><span style="color:#AAAACA">node-version</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">&#x27;12.9&#x27;</span><span style="color:#AAAACA">                       </span><span style="color:#787890;font-style:italic"># Set Node.js Version</span></span>
<span class="line"><span style="color:#AAAACA">        </span><span style="color:#AAAACA">registry-url</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">&#x27;https://registry.npmjs.org&#x27;</span><span style="color:#AAAACA"> </span><span style="color:#787890;font-style:italic"># Set Node.js reigistry</span></span>
<span class="line"><span style="color:#AAAACA">    - </span><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">Deploy Info</span><span style="color:#AAAACA">                            </span><span style="color:#787890;font-style:italic"># Print GitHub Deploy info</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">env</span><span style="color:#AAAACA">:</span></span>
<span class="line"><span style="color:#AAAACA">        </span><span style="color:#AAAACA">GITHUB_CONTEXT</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">${{ toJson(github) }}</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">run</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">echo &quot;$GITHUB_CONTEXT&quot;</span></span>
<span class="line"><span style="color:#AAAACA">    - </span><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">Install</span><span style="color:#AAAACA">                                </span><span style="color:#787890;font-style:italic"># Install dependancies</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">run</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">npm install</span></span>
<span class="line"><span style="color:#AAAACA">    - </span><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">Build</span><span style="color:#AAAACA">                                  </span><span style="color:#787890;font-style:italic"># Build app if needed</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">run</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">npm run build --if-present</span></span>
<span class="line"><span style="color:#AAAACA">    - </span><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">Test</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">run</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">npm run test --if-present</span><span style="color:#AAAACA">               </span><span style="color:#787890;font-style:italic"># Run tests if needed</span></span>
<span class="line"><span style="color:#AAAACA">    - </span><span style="color:#AAAACA">name</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">Publish</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">if</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">github.event_name == &#x27;release&#x27; &amp;&amp; github.event.action == &#x27;published&#x27;</span><span style="color:#AAAACA"> </span><span style="color:#787890;font-style:italic"># Check if publish step should run</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">run</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">npm publish --access public</span><span style="color:#AAAACA">             </span><span style="color:#787890;font-style:italic"># Publish package</span></span>
<span class="line"><span style="color:#AAAACA">      </span><span style="color:#AAAACA">env</span><span style="color:#AAAACA">:</span></span>
<span class="line"><span style="color:#AAAACA">        </span><span style="color:#AAAACA">NODE_AUTH_TOKEN</span><span style="color:#AAAACA">: </span><span style="color:#DD672C">${{ secrets.NPM_AUTH_TOKEN }}</span><span style="color:#AAAACA"> </span><span style="color:#787890;font-style:italic"># Set NPM auth token from GitHub Secrets</span></span></code></pre></div>
<a id="org515fedd"></a>
<h2 id="setting-npm-auth-token-secret" class="min-w-0 box-border m-0 [font-family:var(--font-serif)] text-xl sm:text-2xl font-medium mt-2 mb-1"><a href="#setting-npm-auth-token-secret" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad] anchor"><span class="icon icon-link"></span></a>Setting NPM Auth Token Secret</h2>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">Simply go to your repo <strong class="font-semibold">Settings</strong> and select the <strong class="font-semibold">Secrets</strong> tab.</p>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">Then <strong class="font-semibold">Add a new secret</strong> with the <strong class="font-semibold">Name</strong> of <code>NPM_AUTH_TOKEN</code> and set the <strong class="font-semibold">Value</strong> to your <a href="https://docs.npmjs.com/creating-and-viewing-authentication-tokens" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">NPM token</a>.</p>
<a id="org5d470fc"></a>
<h2 id="adding-the-github-actions-badge" class="min-w-0 box-border m-0 [font-family:var(--font-serif)] text-xl sm:text-2xl font-medium mt-2 mb-1"><a href="#adding-the-github-actions-badge" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad] anchor"><span class="icon icon-link"></span></a>Adding the GitHub Actions badge</h2>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]"><a href="http://github.com" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">GitHub</a> now offers an undocumented API which will return nice <a href="https://travis-ci.org/" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">Travis CI</a> like status badge.</p>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">An example can be seen on the <a href="https://github.com/actions/toolkit" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">actions/toolkit</a> repo.</p>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">The format for the API is as follows:</p>
<div data-rehype-pretty-code-fragment=""><pre data-language="markdown" data-theme="default" class="rounded-xl mb-2.5 mt-2 [line-height:1.42] bg-[#111118] text-[#aaaaca] [overflow:auto] [overflow-wrap:normal] p-6 text-xs sm:text-sm"><code data-language="markdown" data-theme="default"><span class="line"><span style="color:#AAAACA">https://github.com/&lt;user|org&gt;/&lt;repo&gt;/&lt;action_name&gt;/badge.svg</span></span></code></pre></div>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">The <code>action_name</code> propery is the <code>name</code> field in the <a href="https://yaml.org/" target="_blank" rel="noopener noreferrer" class="text-[#fb8556] underline [text-underline-offset:5px] decoration-transparent decoration-wavy hover:decoration-[#f7c2ad]">YAML</a> which in this case is <code>build</code>.</p>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">An example of this would be:</p>
<div data-rehype-pretty-code-fragment=""><pre data-language="markdown" data-theme="default" class="rounded-xl mb-2.5 mt-2 [line-height:1.42] bg-[#111118] text-[#aaaaca] [overflow:auto] [overflow-wrap:normal] p-6 text-xs sm:text-sm"><code data-language="markdown" data-theme="default"><span class="line"><span style="color:#AAAACA">https://github.com/woofers/ludum-dare-badges/workflows/build/badge.svg</span></span></code></pre></div>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">To make it even nicer we can link the badge to our repo&#x27;s actions page:</p>
<div data-rehype-pretty-code-fragment=""><pre data-language="markdown" data-theme="default" class="rounded-xl mb-2.5 mt-2 [line-height:1.42] bg-[#111118] text-[#aaaaca] [overflow:auto] [overflow-wrap:normal] p-6 text-xs sm:text-sm"><code data-language="markdown" data-theme="default"><span class="line"><span style="color:#AAAACA">[</span><span style="color:#AAAACA">![img](</span><span style="color:#FE8C52;text-decoration:underline">https://github.com/woofers/ludum-dare-badges/workflows/build/badge.svg</span><span style="color:#AAAACA">)</span><span style="color:#AAAACA">](</span><span style="color:#FE8C52;text-decoration:underline">https://github.com/woofers/ludum-dare-badges/actions</span><span style="color:#AAAACA">)</span></span></code></pre></div>
<p class="min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]">It will look something like this:</p></article><!--$--><!--/$--><hr class="my-4 border-gray-200 dark-mode:border-zinc-300 mt-8 mb-2"/></div><a class="min-w-0 box-border m-0 flex justify-center flex-row gap-x-0 pb-8" href="/"><span class="min-w-0 box-border m-0 flex flex-col-reverse gap-y-0 text-[#c7c7c6] dark-mode:text-[#2e2e2e]"><span class="min-w-0 box-border m-0 [font-family:var(--font-serif)] text-5xl font-bold [font-size:2.4rem]">Jaxson</span><span class="min-w-0 box-border m-0 [font-family:var(--font-serif)] text-5xl italic font-light [margin-bottom:-8px] [margin-left:28px] [font-size:1.2rem]">Van Doorn</span></span></a></div></main></div></div><script src="/_next/static/chunks/webpack-f1708cd464e6335f.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[7952,[\"952\",\"static/chunks/952-93a0312470798b49.js\",\"60\",\"static/chunks/60-b5a4faedd1c7331c.js\",\"463\",\"static/chunks/463-e6ae5b1b34dd90ae.js\",\"489\",\"static/chunks/app/(index)/blog/%5B...slug%5D/page-a938057c8b529094.js\"],\"ViewTransitions\"]\n3:I[5217,[],\"\"]\n4:I[7877,[],\"\"]\n5:I[7952,[\"952\",\"static/chunks/952-93a0312470798b49.js\",\"60\",\"static/chunks/60-b5a4faedd1c7331c.js\",\"463\",\"static/chunks/463-e6ae5b1b34dd90ae.js\",\"489\",\"static/chunks/app/(index)/blog/%5B...slug%5D/page-a938057c8b529094.js\"],\"Link\"]\n9:I[5683,[],\"\"]\n:HL[\"/_next/static/media/0703289cbb03d1b5-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/2f66d2cded5eb62b-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/4195ccbd93429073-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/4b25ba58b96bf829-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/5191fc87febab105-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/6f4b1b8a3bb362a3-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/a155a31b509d9798-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/b1373ee6909ce2f4-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/b817805ccb9a2b4a-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/be78684d432e3822-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/c8897484f20cb9bc-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/dd2c1f56eea99b69-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/e6581a79ce8b3a05-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/ee0a4d0f22f144a3-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/017825a64ef30acf.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"jXTUow4yCUmqave0BMZ2f\",\"p\":\"\",\"c\":[\"\",\"blog\",\"yaml-github-actions\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"(index)\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"yaml-github-actions\",\"c\"],{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/017825a64ef30acf.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L2\",null,{\"children\":[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"light __variable_cc5bd2 __variable_9f010c\",\"children\":[[\"$\",\"head\",null,{}],[\"$\",\"body\",null,{\"children\":[\"$\",\"div\",null,{\"id\":\"__next\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex min-h-screen flex-col text-zinc-900 bg-zinc-100 dark-mode:text-neutral-800\",\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]}]]}]}]]}],{\"children\":[\"(index)\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"main\",null,{\"className\":\"min-w-0 box-border m-0 flex grow\",\"style\":\"$undefined\",\"children\":[\"$\",\"div\",null,{\"className\":\"min-w-0 box-border m-0 flex flex-col grow gap-y-0 max-h-screen overflow-y-auto fade-morph\",\"style\":\"$undefined\",\"children\":[[\"$\",\"div\",null,{\"className\":\"min-w-0 box-border m-0 grow flex flex-col mx-auto w-full max-w-container [max-width:960px] px-4 sm:px-6 lg:px-8 py-2 sm:py-3 lg:py-4\",\"style\":\"$undefined\",\"children\":[[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":\"$0:f:0:1:1:props:children:1:props:children:props:children:1:props:children:props:children:props:children:props:notFound:0:1:props:style\",\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":\"$0:f:0:1:1:props:children:1:props:children:props:children:1:props:children:props:children:props:children:props:notFound:0:1:props:children:props:children:1:props:style\",\"children\":404}],[\"$\",\"div\",null,{\"style\":\"$0:f:0:1:1:props:children:1:props:children:props:children:1:props:children:props:children:props:children:props:notFound:0:1:props:children:props:children:2:props:style\",\"children\":[\"$\",\"h2\",null,{\"style\":\"$0:f:0:1:1:props:children:1:props:children:props:children:1:props:children:props:children:props:children:props:notFound:0:1:props:children:props:children:2:props:children:props:style\",\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],[\"$\",\"hr\",null,{\"className\":\"my-4 border-gray-200 dark-mode:border-zinc-300 mt-8 mb-2\"}]]}],[\"$\",\"$L5\",null,{\"href\":\"/\",\"className\":\"min-w-0 box-border m-0 flex justify-center flex-row gap-x-0 pb-8\",\"style\":\"$undefined\",\"children\":[\"$\",\"span\",null,{\"className\":\"min-w-0 box-border m-0 flex flex-col-reverse gap-y-0 text-[#c7c7c6] dark-mode:text-[#2e2e2e]\",\"style\":\"$undefined\",\"children\":[[\"$\",\"span\",null,{\"className\":\"min-w-0 box-border m-0 [font-family:var(--font-serif)] text-5xl font-bold [font-size:2.4rem]\",\"style\":\"$undefined\",\"children\":\"Jaxson\"}],[\"$\",\"span\",null,{\"className\":\"min-w-0 box-border m-0 [font-family:var(--font-serif)] text-5xl italic font-light [margin-bottom:-8px] [margin-left:28px] [font-size:1.2rem]\",\"style\":\"$undefined\",\"children\":\"Van Doorn\"}]]}]}]]}]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"yaml-github-actions\",\"c\"],[\"$\",\"$1\",\"c\",{\"children\":[null,\"$L6\"]}],{\"children\":[\"__PAGE__\",\"$L7\",{},null,false]},null,false]},null,false]},null,false]},null,false],\"$L8\",false]],\"m\":\"$undefined\",\"G\":[\"$9\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"b:I[7815,[],\"OutletBoundary\"]\nd:I[781,[],\"AsyncMetadataOutlet\"]\nf:I[7815,[],\"ViewportBoundary\"]\n11:I[7815,[],\"MetadataBoundary\"]\n12:\"$Sreact.suspense\"\n6:[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]\n7:[\"$\",\"$1\",\"c\",{\"children\":[\"$La\",null,[\"$\",\"$Lb\",null,{\"children\":[\"$Lc\",[\"$\",\"$Ld\",null,{\"promise\":\"$@e\"}]]}]]}]\n8:[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$Lf\",null,{\"children\":\"$L10\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$L11\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$12\",null,{\"fallback\":null,\"children\":\"$L13\"}]}]}]]}]\n"])</script><script>self.__next_f.push([1,"14:I[4463,[\"952\",\"static/chunks/952-93a0312470798b49.js\",\"60\",\"static/chunks/60-b5a4faedd1c7331c.js\",\"463\",\"static/chunks/463-e6ae5b1b34dd90ae.js\",\"489\",\"static/chunks/app/(index)/blog/%5B...slug%5D/page-a938057c8b529094.js\"],\"Mdx\"]\n15:T82cd,"])</script><script>self.__next_f.push([1,"var Component=(()=\u003e{var h=Object.create;var c=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var y=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty;var u=(n,e)=\u003e()=\u003e(e||n((e={exports:{}}).exports,e),e.exports),m=(n,e)=\u003e{for(var s in e)c(n,s,{get:e[s],enumerable:!0})},a=(n,e,s,A)=\u003e{if(e\u0026\u0026typeof e==\"object\"||typeof e==\"function\")for(let r of p(e))!C.call(n,r)\u0026\u0026r!==s\u0026\u0026c(n,r,{get:()=\u003ee[r],enumerable:!(A=d(e,r))||A.enumerable});return n};var g=(n,e,s)=\u003e(s=n!=null?h(y(n)):{},a(e||!n||!n.__esModule?c(s,\"default\",{value:n,enumerable:!0}):s,n)),f=n=\u003ea(c({},\"__esModule\",{value:!0}),n);var o=u((v,i)=\u003e{i.exports=_jsx_runtime});var w={};m(w,{default:()=\u003eD,frontmatter:()=\u003eb});var l=g(o()),b={layout:\"post\",title:\"NPM package deployment using YAML GitHub Actions\",date:new Date(15663456e5),description:\"Recently GitHub announced that GitHub Actions will be moving away from the original HCL syntax in-favour of a YAML format similar to Travis CI and Bitbucket Pipelines. This means that HCL style actions will no longer work after September 30, 2019. It is possible to migrate using a migration script however in-some cases it may be required to reconfigure. This particular issue occurred to me as actions which return a neutral result seem to fail the whole build with the YAML format.\"};function t(n){let e=Object.assign({p:\"p\",a:\"a\",h2:\"h2\",span:\"span\",ul:\"ul\",li:\"li\",code:\"code\",h3:\"h3\",strong:\"strong\",div:\"div\",pre:\"pre\"},n.components);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(e.p,{children:[\"Recently \",(0,l.jsx)(e.a,{href:\"http://github.com\",children:\"GitHub\"}),\" announced that \",(0,l.jsx)(e.a,{href:\"https://github.com/features/actions\",children:\"GitHub Actions\"}),\" will be \",(0,l.jsx)(e.a,{href:\"https://github.blog/2019-08-08-github-actions-now-supports-ci-cd/\",children:\"moving away\"}),\" from the original \",(0,l.jsx)(e.a,{href:\"https://github.com/hashicorp/hcl\",children:\"HCL\"}),\" syntax in-favour of a \",(0,l.jsx)(e.a,{href:\"https://yaml.org/\",children:\"YAML\"}),` format\nsimilar to `,(0,l.jsx)(e.a,{href:\"https://travis-ci.org/\",children:\"Travis CI\"}),\" and \",(0,l.jsx)(e.a,{href:\"https://bitbucket.org/product/features/pipelines\",children:\"Bitbucket Pipelines\"}),\".  This means that \",(0,l.jsx)(e.a,{href:\"https://github.com/hashicorp/hcl\",children:\"HCL\"}),\" style actions will no longer work \",(0,l.jsx)(e.a,{href:\"https://developer.github.com/actions/\",children:\"after September 30, 2019\"}),\".  It is possible to migrate using a \",(0,l.jsx)(e.a,{href:\"https://help.github.com/en/articles/migrating-github-actions-from-hcl-syntax-to-yaml-syntax\",children:\"migration script\"}),\" however in-some cases it may be required to reconfigure.\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"This particular issue occurred to me as actions which return a neutral result seem to fail the whole build with the \",(0,l.jsx)(e.a,{href:\"https://yaml.org/\",children:\"YAML\"}),\" format.  This means that using \",(0,l.jsx)(e.a,{href:\"https://github.com/actions/bin/tree/master/filter/bin\",children:\"actions/bin/filter\"}),\" to trigger a deploy would fail the build unless a release tag was found.  With this in mind, reconfiguring my \",(0,l.jsx)(e.a,{href:\"https://github.com/features/actions\",children:\"GitHub Actions\"}),\" seemed like the best choice.\"]}),`\n`,(0,l.jsx)(\"a\",{id:\"orgb58448b\"}),`\n`,(0,l.jsxs)(e.h2,{id:\"desired-behaviour\",children:[(0,l.jsx)(e.a,{className:\"anchor\",href:\"#desired-behaviour\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Desired Behaviour\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"My particular use of \",(0,l.jsx)(e.a,{href:\"https://github.com/features/actions\",children:\"GitHub Actions\"}),\" is for deploying my small \",(0,l.jsx)(e.a,{href:\"https://docs.npmjs.com/creating-node-js-modules\",children:\"NPM packages\"}),\".\"]}),`\n`,(0,l.jsx)(e.p,{children:\"To keep it simple I wanted the following to occur:\"}),`\n`,(0,l.jsxs)(e.ul,{children:[`\n`,(0,l.jsx)(e.li,{children:\"Install dependencies, Build and Test package on each commit\"}),`\n`,(0,l.jsx)(e.li,{children:\"Publish package if a release tag was created\"}),`\n`]}),`\n`,(0,l.jsx)(\"a\",{id:\"org521573d\"}),`\n`,(0,l.jsxs)(e.h2,{id:\"creating-the-action-configuration\",children:[(0,l.jsx)(e.a,{className:\"anchor\",href:\"#creating-the-action-configuration\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Creating the Action Configuration\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Create the file \",(0,l.jsx)(e.code,{children:\".github/workflows/workflow.yml\"})]}),`\n`,(0,l.jsx)(\"a\",{id:\"org9bc8afb\"}),`\n`,(0,l.jsxs)(e.h3,{id:\"checking-for-tag\",children:[(0,l.jsx)(e.a,{className:\"anchor\",href:\"#checking-for-tag\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Checking for Tag\"]}),`\n`,(0,l.jsx)(e.p,{children:\"This method simply builds and tests the package on any commit.\"}),`\n`,(0,l.jsxs)(e.p,{children:[\"Then if it finds a tag starting with \",(0,l.jsx)(e.strong,{children:\"v\"}),\", it will trigger a deploy.\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"So if a \",(0,l.jsx)(e.a,{href:\"https://help.github.com/en/articles/creating-releases\",children:\"GitHub Release\"}),\" is created with the tag \",(0,l.jsx)(e.strong,{children:\"v2.3.4\"}),\", it will trigger a deploy.\"]}),`\n`,(0,l.jsx)(e.p,{children:\"This is a bit naive however for my purposes I usually don't tag unless its a release.\"}),`\n`,(0,l.jsx)(e.p,{children:\"One advantage of checking for a tag this way is that it cuts down on unneeded builds as a whole build can only ever run 1 or 2 times (2 in the case a build is deployed).\"}),`\n`,(0,l.jsxs)(e.p,{children:[\"The \",(0,l.jsx)(e.a,{href:\"https://github.com/features/actions\",children:\"GitHub Actions\"}),\" docs mentions being able to \",(0,l.jsx)(e.a,{href:\"https://help.github.com/en/articles/workflow-syntax-for-github-actions#example-restricting-the-workflow-run-to-specific-refs-and-paths\",children:\"restrict actions\"}),\" to certain branches or tags however I could not get this to work.\"]}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{\"data-language\":\"yaml\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.code,{\"data-language\":\"yaml\",\"data-theme\":\"default\",children:[(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"build\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Name Action Build\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"on\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": [\"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"push\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"]  \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Trigger on push\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"jobs\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"runs-on\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"ubuntu-latest\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"                         \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Run on Ubuntu Docker image\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"steps\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    - \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"Checkout Repo\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"                          \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Checkout repo\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"uses\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"actions/checkout@v1\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    - \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"Use Node.js\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"                            \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Configure Node.js\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"uses\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"actions/setup-node@v1\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"with\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"node-version\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"'12.9'\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"                       \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Set Node.js Version\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"registry-url\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"'https://registry.npmjs.org'\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Set Node.js reigistry\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    - \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"Deploy Info\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"                            \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Print GitHub Deploy info\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"env\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"GITHUB_CONTEXT\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"${{ toJson(github) }}\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:'echo \"$GITHUB_CONTEXT\"'})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    - \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"Install\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"                                \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Install dependancies\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"npm install\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    - \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"Build\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"                                  \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Build app if needed\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"npm run build --if-present\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    - \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"Test\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"npm run test --if-present\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"               \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Run tests if needed\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    - \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"Publish\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"if\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"startsWith(github.ref, 'refs/tags/v')\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Check if publish step should run\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"npm publish --access public\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"             \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Publish package\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"env\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"NODE_AUTH_TOKEN\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"${{ secrets.NPM_AUTH_TOKEN }}\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Set NPM auth token from GitHub Secrets\"})]})]})})}),`\n`,(0,l.jsx)(\"a\",{id:\"org2d248b4\"}),`\n`,(0,l.jsxs)(e.h3,{id:\"checking-for-a-release\",children:[(0,l.jsx)(e.a,{className:\"anchor\",href:\"#checking-for-a-release\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Checking for a Release\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"If you found the previous method too naive, you may want to check for a \",(0,l.jsx)(e.a,{href:\"https://help.github.com/en/articles/creating-releases\",children:\"GitHub Release\"}),\" before triggering a deploy.\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"The drawback to this is that a few extraneous builds will be triggered as the \",(0,l.jsx)(e.code,{children:\"release\"}),\" event will fire both when the release is \",(0,l.jsx)(e.code,{children:\"created\"}),\" and \",(0,l.jsx)(e.code,{children:\"published\"}),\".  As far as I am aware this can not be restricted using the \",(0,l.jsx)(e.code,{children:\"on\"}),\" property.\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"To ensure we only deploy once, we will indicate to only run the \",(0,l.jsx)(e.strong,{children:\"Publish\"}),\" step when a release is \",(0,l.jsx)(e.code,{children:\"published\"}),\".\"]}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{\"data-language\":\"yaml\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.code,{\"data-language\":\"yaml\",\"data-theme\":\"default\",children:[(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"build\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"on\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"push\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":     \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Run build on push (commit in most cases)\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"tag\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": [] \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Only run build if not tagged\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"release\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":  \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Run build on release\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"tag\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    - \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"v*\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Check for release tag\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"jobs\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"  \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"runs-on\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"ubuntu-latest\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"                         \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Run on Ubuntu Docker image\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"steps\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    - \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"Checkout Repo\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"                          \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Checkout repo\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"uses\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"actions/checkout@v1\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    - \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"Use Node.js\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"                            \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Configure Node.js\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"uses\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"actions/setup-node@v1\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"with\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"node-version\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"'12.9'\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"                       \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Set Node.js Version\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"registry-url\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"'https://registry.npmjs.org'\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Set Node.js reigistry\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    - \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"Deploy Info\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"                            \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Print GitHub Deploy info\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"env\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"GITHUB_CONTEXT\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"${{ toJson(github) }}\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:'echo \"$GITHUB_CONTEXT\"'})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    - \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"Install\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"                                \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Install dependancies\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"npm install\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    - \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"Build\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"                                  \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Build app if needed\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"npm run build --if-present\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    - \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"Test\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"npm run test --if-present\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"               \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Run tests if needed\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"    - \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"Publish\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"if\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"github.event_name == 'release' \u0026\u0026 github.event.action == 'published'\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Check if publish step should run\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"run\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"npm publish --access public\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"             \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Publish package\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"      \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"env\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\":\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"        \"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"NODE_AUTH_TOKEN\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\": \"}),(0,l.jsx)(e.span,{style:{color:\"#DD672C\"},children:\"${{ secrets.NPM_AUTH_TOKEN }}\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\" \"}),(0,l.jsx)(e.span,{style:{color:\"#787890\",fontStyle:\"italic\"},children:\"# Set NPM auth token from GitHub Secrets\"})]})]})})}),`\n`,(0,l.jsx)(\"a\",{id:\"org515fedd\"}),`\n`,(0,l.jsxs)(e.h2,{id:\"setting-npm-auth-token-secret\",children:[(0,l.jsx)(e.a,{className:\"anchor\",href:\"#setting-npm-auth-token-secret\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Setting NPM Auth Token Secret\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Simply go to your repo \",(0,l.jsx)(e.strong,{children:\"Settings\"}),\" and select the \",(0,l.jsx)(e.strong,{children:\"Secrets\"}),\" tab.\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Then \",(0,l.jsx)(e.strong,{children:\"Add a new secret\"}),\" with the \",(0,l.jsx)(e.strong,{children:\"Name\"}),\" of \",(0,l.jsx)(e.code,{children:\"NPM_AUTH_TOKEN\"}),\" and set the \",(0,l.jsx)(e.strong,{children:\"Value\"}),\" to your \",(0,l.jsx)(e.a,{href:\"https://docs.npmjs.com/creating-and-viewing-authentication-tokens\",children:\"NPM token\"}),\".\"]}),`\n`,(0,l.jsx)(\"a\",{id:\"org5d470fc\"}),`\n`,(0,l.jsxs)(e.h2,{id:\"adding-the-github-actions-badge\",children:[(0,l.jsx)(e.a,{className:\"anchor\",href:\"#adding-the-github-actions-badge\",children:(0,l.jsx)(e.span,{className:\"icon icon-link\"})}),\"Adding the GitHub Actions badge\"]}),`\n`,(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.a,{href:\"http://github.com\",children:\"GitHub\"}),\" now offers an undocumented API which will return nice \",(0,l.jsx)(e.a,{href:\"https://travis-ci.org/\",children:\"Travis CI\"}),\" like status badge.\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"An example can be seen on the \",(0,l.jsx)(e.a,{href:\"https://github.com/actions/toolkit\",children:\"actions/toolkit\"}),\" repo.\"]}),`\n`,(0,l.jsx)(e.p,{children:\"The format for the API is as follows:\"}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{\"data-language\":\"markdown\",\"data-theme\":\"default\",children:(0,l.jsx)(e.code,{\"data-language\":\"markdown\",\"data-theme\":\"default\",children:(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"https://github.com/\u003cuser|org\u003e/\u003crepo\u003e/\u003caction_name\u003e/badge.svg\"})})})})}),`\n`,(0,l.jsxs)(e.p,{children:[\"The \",(0,l.jsx)(e.code,{children:\"action_name\"}),\" propery is the \",(0,l.jsx)(e.code,{children:\"name\"}),\" field in the \",(0,l.jsx)(e.a,{href:\"https://yaml.org/\",children:\"YAML\"}),\" which in this case is \",(0,l.jsx)(e.code,{children:\"build\"}),\".\"]}),`\n`,(0,l.jsx)(e.p,{children:\"An example of this would be:\"}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{\"data-language\":\"markdown\",\"data-theme\":\"default\",children:(0,l.jsx)(e.code,{\"data-language\":\"markdown\",\"data-theme\":\"default\",children:(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"https://github.com/woofers/ludum-dare-badges/workflows/build/badge.svg\"})})})})}),`\n`,(0,l.jsx)(e.p,{children:\"To make it even nicer we can link the badge to our repo's actions page:\"}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{\"data-language\":\"markdown\",\"data-theme\":\"default\",children:(0,l.jsx)(e.code,{\"data-language\":\"markdown\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"[\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"![img](\"}),(0,l.jsx)(e.span,{style:{color:\"#FE8C52\",textDecoration:\"underline\"},children:\"https://github.com/woofers/ludum-dare-badges/workflows/build/badge.svg\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\")\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\"](\"}),(0,l.jsx)(e.span,{style:{color:\"#FE8C52\",textDecoration:\"underline\"},children:\"https://github.com/woofers/ludum-dare-badges/actions\"}),(0,l.jsx)(e.span,{style:{color:\"#AAAACA\"},children:\")\"})]})})})}),`\n`,(0,l.jsx)(e.p,{children:\"It will look something like this:\"})]})}function N(n={}){let{wrapper:e}=n.components||{};return e?(0,l.jsx)(e,Object.assign({},n,{children:(0,l.jsx)(t,n)})):t(n)}var D=N;return f(w);})();\n;return Component;"])</script><script>self.__next_f.push([1,"a:[\"$\",\"article\",null,{\"className\":\"flex-grow pt-6 prose relative\",\"children\":[[\"$\",\"div\",null,{\"className\":\"min-w-0 box-border m-0 absolute left-[-14px] top-[-14px] flex justify-end sm:top-[-22px] xl:hidden\",\"style\":\"$undefined\",\"children\":[\"$\",\"$L5\",null,{\"href\":\"/\",\"className\":\"px-4 py-4 block\",\"aria-label\":\"Back\",\"children\":[\"$\",\"span\",null,{\"className\":\"min-w-0 box-border m-0 flex items-center flex-row gap-x-2 text-zinc-500 dark-mode:text-neutral-500\",\"style\":\"$undefined\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 20 20\",\"aria-hidden\":\"true\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"fillRule\":\"evenodd\",\"d\":\"M7.793 2.232a.75.75 0 0 1-.025 1.06L3.622 7.25h10.003a5.375 5.375 0 0 1 0 10.75H10.75a.75.75 0 0 1 0-1.5h2.875a3.875 3.875 0 0 0 0-7.75H3.622l4.146 3.957a.75.75 0 0 1-1.036 1.085l-5.5-5.25a.75.75 0 0 1 0-1.085l5.5-5.25a.75.75 0 0 1 1.06.025Z\",\"clipRule\":\"evenodd\",\"children\":[]}]]],\"className\":\"$undefined\",\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],[\"$\",\"span\",null,{\"className\":\"min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]\",\"style\":\"$undefined\",\"children\":\"back\"}]]}]}]}],[\"$\",\"div\",null,{\"className\":\"min-w-0 box-border m-0 sticky hidden top-0 left-0 h-0 xl:block\",\"style\":\"$undefined\",\"children\":[\"$\",\"div\",null,{\"className\":\"min-w-0 box-border m-0 absolute top-[16px] left-[-160px]\",\"style\":\"$undefined\",\"children\":[\"$\",\"$L5\",null,{\"href\":\"/\",\"className\":\"px-4 py-4 block\",\"aria-label\":\"Back\",\"children\":[\"$\",\"span\",null,{\"className\":\"min-w-0 box-border m-0 flex items-center flex-row gap-x-2 text-zinc-500 dark-mode:text-neutral-500\",\"style\":\"$undefined\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 20 20\",\"aria-hidden\":\"true\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"fillRule\":\"evenodd\",\"d\":\"M7.793 2.232a.75.75 0 0 1-.025 1.06L3.622 7.25h10.003a5.375 5.375 0 0 1 0 10.75H10.75a.75.75 0 0 1 0-1.5h2.875a3.875 3.875 0 0 0 0-7.75H3.622l4.146 3.957a.75.75 0 0 1-1.036 1.085l-5.5-5.25a.75.75 0 0 1 0-1.085l5.5-5.25a.75.75 0 0 1 1.06.025Z\",\"clipRule\":\"evenodd\",\"children\":[]}]]],\"className\":\"$undefined\",\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],[\"$\",\"span\",null,{\"className\":\"min-w-0 box-border m-0 text-sm [line-height:1.375rem] sm:text-base sm:[line-height:1.75rem]\",\"style\":\"$undefined\",\"children\":\"back\"}]]}]}]}]}],false,[[\"$\",\"h1\",null,{\"className\":\"min-w-0 box-border m-0 [font-family:var(--font-serif)] text-3xl font-medium mt-2.5 sm:mt-0 text-morph\",\"style\":\"$undefined\",\"children\":\"NPM package deployment using YAML GitHub Actions\"}],[\"$\",\"p\",null,{\"className\":\"min-w-0 box-border m-0 text-lg sm:text-xl text-zinc-500 dark-mode:text-neutral-500\",\"style\":\"$undefined\",\"children\":\"Wednesday, August 21, 2019\"}],[\"$\",\"hr\",null,{\"className\":\"my-4 border-gray-200 dark-mode:border-zinc-300\"}],[\"$\",\"$L14\",null,{\"code\":\"$15\"}]]]}]\n"])</script><script>self.__next_f.push([1,"10:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1, viewport-fit=cover\"}],[\"$\",\"meta\",\"2\",{\"name\":\"theme-color\",\"content\":\"#f4f4f5\"}]]\nc:null\n"])</script><script>self.__next_f.push([1,"16:I[1074,[],\"IconMark\"]\n"])</script><script>self.__next_f.push([1,"e:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"NPM package deployment using YAML GitHub Actions | Jaxson Van Doorn\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"All-around developer, half-designer and tinkerer.\"}],[\"$\",\"link\",\"2\",{\"rel\":\"manifest\",\"href\":\"/manifest.webmanifest\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"meta\",\"3\",{\"name\":\"creator\",\"content\":\"Jaxson Van Doorn\"}],[\"$\",\"meta\",\"4\",{\"name\":\"publisher\",\"content\":\"Jaxson Van Doorn\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:title\",\"content\":\"Jaxson Van Doorn\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:description\",\"content\":\"All-around developer, half-designer and tinkerer.\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:image:type\",\"content\":\"image/png\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:image\",\"content\":\"https://jaxs.onl/meta-image.png\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:image:alt\",\"content\":\"Cover image for jaxs.onl\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:image:width\",\"content\":\"1200\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:image:height\",\"content\":\"630\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:creator\",\"content\":\"@jaxsonvandoorn\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:title\",\"content\":\"NPM package deployment using YAML GitHub Actions\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:description\",\"content\":\"All-around developer, half-designer and tinkerer.\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:image\",\"content\":\"https://jaxs.onl/meta-image.png\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:image:alt\",\"content\":\"Cover image for jaxs.onl\"}],[\"$\",\"link\",\"18\",{\"rel\":\"shortcut icon\",\"href\":\"/favicon.png\"}],[\"$\",\"link\",\"19\",{\"rel\":\"icon\",\"href\":\"/favicon.png\"}],[\"$\",\"link\",\"20\",{\"rel\":\"apple-touch-icon\",\"href\":\"/icons/mask-32x32.png\",\"sizes\":\"32x32\",\"type\":\"image/png\"}],[\"$\",\"link\",\"21\",{\"rel\":\"apple-touch-icon\",\"href\":\"/icons/mask-48x48.png\",\"sizes\":\"48x48\",\"type\":\"image/png\"}],[\"$\",\"link\",\"22\",{\"rel\":\"apple-touch-icon\",\"href\":\"/icons/mask-72x72.png\",\"sizes\":\"72x72\",\"type\":\"image/png\"}],[\"$\",\"link\",\"23\",{\"rel\":\"apple-touch-icon\",\"href\":\"/icons/mask-144x144.png\",\"sizes\":\"144x144\",\"type\":\"image/png\"}],[\"$\",\"link\",\"24\",{\"rel\":\"apple-touch-icon\",\"href\":\"/icons/mask-192x192.png\",\"sizes\":\"192x192\",\"type\":\"image/png\"}],[\"$\",\"link\",\"25\",{\"rel\":\"apple-touch-icon\",\"href\":\"/icons/mask-256x256.png\",\"sizes\":\"256x256\",\"type\":\"image/png\"}],[\"$\",\"link\",\"26\",{\"rel\":\"apple-touch-icon\",\"href\":\"/icons/mask-384x384.png\",\"sizes\":\"384x384\",\"type\":\"image/png\"}],[\"$\",\"link\",\"27\",{\"rel\":\"apple-touch-icon\",\"href\":\"/icons/mask-512x512.png\",\"sizes\":\"512x512\",\"type\":\"image/png\"}],[\"$\",\"$L16\",\"28\",{}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"13:\"$e:metadata\"\n"])</script></body></html>